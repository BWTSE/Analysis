---
title: "Variable Names"
output: html_notebook
---

Variable names:

```{r}

d.completed %>%
  ggplot(aes(x=var_names_new_good.ratio, fill=high_debt_version)) + 
  geom_boxplot()

d.completed %>%
  filter(!is.nan(var_names_copied_good.ratio)) %>%
  ggplot(aes(x=var_names_copied_good.ratio, fill=high_debt_version)) + 
  geom_boxplot()


mean(d.completed$var_names_new_good)
var(d.completed$var_names_new_good)
```



```{r}
# Sample model example
sample <- posterior_predict(var_names0, newdata = data.frame(high_debt_version = "false", var_names_new_all = 10), re_formula = NA)


```

Basic model with binomial distribution:

```{r}
variable_names0 <- brm(
  var_names_new_good | trials(var_names_new_all) ~ 1 + (1 |c| session),
  family = binomial(),
  data = as.data.frame(d.both_completed),
  prior = c(
    prior(normal(2, 1), class = "Intercept"),
    prior(exponential(1), class = "sd")
  ),
  control = list(adapt_delta = 0.95),
  #empty = TRUE
  file = "fits/variable_names0",
  file_refit = "on_change"
)

```

Adding debt level as predictor:

```{r}
variable_names1.with <- extendable_model(
  base_name = "variable_names1",
  base_formula = "var_names_new_good | trials(var_names_new_all) ~ 1 + high_debt_version + (1 | c | session)",
  base_priors = c(
    prior(normal(0, 1), class = "b"),
    prior(normal(2, 1), class = "Intercept"),
    prior(exponential(1), class = "sd")
  ),
  family = binomial(),
  data = d.both_completed,
  base_control = list(adapt_delta = 0.95)
)


variable_names1 <- variable_names1.with()
summary(variable_names1)
```

Compare

```{r}
loo(variable_names0, variable_names1.with())

```


```{r}
summary(variable_names1.with("work_domain"))
```

```{r}
summary(variable_names1.with("work_experience_programming.s"))
```


```{r}
summary(variable_names1.with("work_experience_java.s"))
```

```{r}
summary(variable_names1.with("education_field"))
```

```{r}
summary(variable_names1.with(
  "mo(education_level)", 
  c(
    prior(dirichlet(2), class = "simo", coef = "moeducation_level1")
  )
))
```

```{r}
summary(variable_names1.with("workplace_peer_review"))
```

```{r}
summary(variable_names1.with("workplace_td_tracking"))
```

```{r}
summary(variable_names1.with("workplace_pair_programming"))
```

```{r}
summary(variable_names1.with("workplace_coding_standards"))
```

```{r}
summary(variable_names1.with("scenario"))
```

```{r}
summary(variable_names1.with("group"))
```

```{r}
loo(
  variable_names1.with(),
  variable_names1.with("work_domain"),
  variable_names1.with("work_experience_programming.s"),
  variable_names1.with("work_experience_java.s"),
  variable_names1.with("education_field"),
  variable_names1.with(
  "mo(education_level)", 
  c(
    prior(dirichlet(2), class = "simo", coef = "moeducation_level1")
  )
  ),
  variable_names1.with("workplace_peer_review"),
  variable_names1.with("workplace_td_tracking"),
  variable_names1.with("workplace_pair_programming"),
  variable_names1.with("workplace_coding_standards"),
  variable_names1.with("scenario"),
  variable_names1.with("group"),
  variable_names1.with(
  c("work_domain", 
    "work_experience_programming.s",
    "work_experience_java.s",
    "education_field",
    "mo(education_level)",
    "workplace_peer_review",
    "workplace_td_tracking",
    "workplace_pair_programming",
    "workplace_coding_standards",
    "scenario",
    "group"
    ),
  c(
    prior(dirichlet(2), class = "simo", coef = "moeducation_level1")
    )
)
)


```


```{r}
loo(
  variable_names1.with(),
  variable_names1.with("work_experience_programming.s"),
  variable_names1.with("work_experience_java.s"),
  variable_names1.with("workplace_peer_review"),
  variable_names1.with("workplace_td_tracking"),
  variable_names1.with("workplace_coding_standards"),
  variable_names1.with(c("scenario","workplace_td_tracking")),
  variable_names1.with(c("scenario","workplace_peer_review")),
  variable_names1.with(c("scenario","work_experience_java.s")),
  variable_names1.with(c("scenario","work_experience_java.s","workplace_td_tracking","workplace_peer_review")),
    variable_names1.with(c("scenario","work_experience_java.s","workplace_td_tracking")),
  variable_names1.with(
  c("work_domain", 
    "work_experience_programming.s",
    "work_experience_java.s",
    "education_field",
    "mo(education_level)",
    "workplace_peer_review",
    "workplace_td_tracking",
    "workplace_pair_programming",
    "workplace_coding_standards",
    "scenario",
    "group"
    ),
  c(
    prior(dirichlet(2), class = "simo", coef = "moeducation_level1")
    )
)
)


```


Candidate models:
  
```{r}
variable_names_cand1 <- variable_names1.with()
summary(variable_names_cand1)
ranef(variable_names_cand1)
plot(variable_names_cand1)
pp_check(variable_names_cand1, type = "bars", nsamples = 100)

```


```{r}
variable_names_cand2 <- variable_names1.with("scenario")
summary(variable_names_cand2)
ranef(variable_names_cand2)
plot(variable_names_cand2)
pp_check(variable_names_cand2, type = "bars", nsamples = 100)

```

```{r}
variable_names_cand3 <- variable_names1.with(c("scenario", "work_experience_java.s"))
summary(variable_names_cand3)
ranef(variable_names_cand3)
plot(variable_names_cand3)
pp_check(variable_names_cand4, type = "bars", nsamples = 100)

```


```{r}
variable_names_cand4 <- variable_names1.with(c("scenario", "work_experience_java.s",     "workplace_td_tracking", "workplace_peer_review"))
summary(variable_names_cand4)
ranef(variable_names_cand4)
plot(variable_names_cand4)
pp_check(variable_names_cand4, type = "bars", nsamples = 100)

```
```{r}
variable_names_cand5 <- variable_names1.with(c("scenario", "work_experience_java.s","workplace_peer_review"))
summary(variable_names_cand5)
ranef(variable_names_cand5)
plot(variable_names_cand5)
pp_check(variable_names_cand5, type = "bars", nsamples = 100)

```

```{r}
loo(variable_names_cand1,variable_names_cand2,variable_names_cand3,variable_names_cand4,variable_names_cand5)
```

Estimate of debt level effect (high_debt_version) seems robust, no predictors appear to affect it significantly. In fact, slightly increases with additional predictors.